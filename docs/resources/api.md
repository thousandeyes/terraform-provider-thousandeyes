---
page_title: "thousandeyes_api Resource - terraform-provider-thousandeyes"
subcategory: ""
description: |-
---

# thousandeyes_api (Resource)

This resource provides visibility into the performance of critical web API endpoints within your application ecosystem. For more information, see [API Tests](https://docs.thousandeyes.com/product-documentation/api-test).

## Example Usage

```terraform
resource "thousandeyes_api" "api_test_example" {
  test_name            = "Example for API Test Resource set from Terraform provider"
  interval             = 120
  alerts_enabled       = false
  url                  = "https://www.thousandeyes.com"
  agents               = [3] #Singapore
  network_measurements = false
  bgp_measurements     = false
  target_time          = 30
  time_limit           = 90
  requests {
    name                  = "Step 1 - GET Request"
    url                   = "https://www.thousandeyes.com"
    method                = "get"
    auth_type             = "basic"
    username              = "test_username"
    password              = "test_password"
    client_authentication = "in-body"

    headers {
      key   = "Accept"
      value = "application/json"
    }

    assertions {
      name     = "status-code"
      operator = "is"
      value    = "200"
    }

    assertions {
      name     = "response-body"
      operator = "includes"
      value    = "timestamp"
    }
  }
  requests {
    name                  = "Step 2 - POST OAuth2 request"
    url                   = "https://www.thousandeyes.com"
    method                = "post"
    auth_type             = "oauth2"
    client_id             = "test_client"
    client_secret         = "test_client_secret"
    scope                 = "test_scope"
    token_url             = "https://www.thousandeyes.com"
    client_authentication = "in-body"

    body = jsonencode({
      firstName = "John"
      lastName  = "Doe"
    })

    headers {
      key   = "Content-Type"
      value = "application/json"
    }

    assertions {
      name     = "status-code"
      operator = "is"
      value    = "401"
    }

    assertions {
      name     = "response-body"
      operator = "includes"
      value    = "error"
    }

    wait_time_ms = 1000 
  }

}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `agents` (Set of String) The list of ThousandEyes agent IDs to use.
- `interval` (Number) The interval to run the test on, in seconds.
- `requests` (Block List, Min: 1) List of API requests (see [below for nested schema](#nestedblock--requests))
- `url` (String) The target URL for the test.

### Optional

- `alert_rules` (Set of String) List of alert rules IDs to apply to the test (get `ruleId` from `/alerts/rules` endpoint. If `alertsEnabled` is set to `true` and `alertRules` is not included on test creation or update, applicable user default alert rules will be used)
- `alerts_enabled` (Boolean) Set to 'true' to enable alerts, or 'false' to disable alerts. The default value is 'true'.
- `bgp_measurements` (Boolean) Enable BGP measurements. Set to true for enabled, false for disabled.
- `collect_proxy_network_data` (Boolean) Indicates whether network data to the proxy should be collected.
- `credentials` (Set of String) The array of credentialID integers. You can get the credentialId from the /credentials endpoint.
- `description` (String) A description of the alert rule. Defaults to an empty string.
- `enabled` (Boolean) Enables or disables the test.
- `follow_redirects` (Boolean) Follow HTTP/301 or HTTP/302 redirect directives. Defaults to 'true'.
- `labels` (Set of String) ["1", "2", "uuid"] The array of label or tag ids.
- `monitors` (Set of String) Contains list of BGP monitor IDs (get `monitorId` from `/monitors` endpoint)
- `mtu_measurements` (Boolean) Measure MTU sizes on the network from agents to the target.
- `network_measurements` (Boolean) Set to 'true' to enable network measurements.
- `num_path_traces` (Number) The number of path traces.
- `override_agent_proxy` (Boolean) Flag indicating if a proxy other than the default should be used. To override the default proxy for agents, set to `true` and specify a value for `overrideProxyId`.
- `override_proxy_id` (String) ID of the proxy to be used if the default proxy is overridden.
- `path_trace_mode` (String) [classic or in-session] Choose 'inSession' to perform the path trace within a TCP session. Default value is 'classic'.
- `predefined_variables` (Block Set) The array of predefined variables (see [below for nested schema](#nestedblock--predefined_variables))
- `probe_mode` (String) [auto, sack, or syn] The probe mode used by end-to-end network tests. This is only valid if the protocol is set to TCP. The default value is AUTO.
- `protocol` (String) The protocol used by dependent network tests (end-to-end, path trace, PMTUD). Default value is tcp.
- `randomized_start_time` (Boolean) Indicates whether agents should randomize the start time in each test round.
- `shared_with_accounts` (Set of String) List of accounts
- `ssl_version_id` (String) Defines the SSL version. 0 for auto, 3 for SSLv3, 4 for TLS v1.0, 5 for TLS v1.1, 6 for TLS v1.2.
- `target_time` (Number) The target time for completion. The default value is 50 percent of the time limit, specified in seconds.
- `test_name` (String) The name of the test.
- `time_limit` (Number) The time limit for the transaction. The default value is 30s.
- `use_public_bgp` (Boolean) Enable to automatically add all available Public BGP Monitors to the test.

### Read-Only

- `created_by` (String) Created by user.
- `created_date` (String) The date of creation.
- `id` (String) The ID of this resource.
- `link` (String) Its value is either a URI [RFC3986] or a URI template [RFC6570].
- `live_share` (Boolean) Set to 'true' for a test shared with your account group, or to 'false' for a normal test.
- `modified_by` (String) Last modified by this user.
- `modified_date` (String) The date the test was last modified. Shown in UTC.
- `saved_event` (Boolean) Set to 'true' for a saved event, or to 'false' for a normal test.
- `test_id` (String) The unique ID of the test.
- `type` (String) The type of test.

<a id="nestedblock--requests"></a>
### Nested Schema for `requests`

Required:

- `name` (String) API step name, must be unique.
- `url` (String) Request url. Supports variables in the format `{{variableName}}`.

Optional:

- `assertions` (Block Set) List of assertion objects. (see [below for nested schema](#nestedblock--requests--assertions))
- `auth_type` (String) [none, basic, bearer-token, oauth2] Auth type will override the Authorization request header.
- `bearer_token` (String, Sensitive) Enter the OAuth body for the HTTP POST request in this field when using OAuth as the authentication mechanism. No special escaping is required. If content is provided in the post body, the `requestMethod` is automatically set to POST.
- `body` (String) POST/PUT request body. Must be in JSON format.
- `client_authentication` (String) [basic-auth-header, in-body] The OAuth2 client authentication location type.
- `client_id` (String, Sensitive) The application ID used when `authType` is set to "oauth2".
- `client_secret` (String, Sensitive) The private client secret used when `authType` is set to "oauth2".
- `collect_api_response` (Boolean) Set to `true` if API response body should be collected and saved. Set to `false` if API response body should not be saved.
- `headers` (Block Set) An array of label IDs used to assign specific Endpoint Agents to the test (get `id` from `/endpoint/labels`). This is applicable when `alertGroupType` is `browser-session`. (see [below for nested schema](#nestedblock--requests--headers))
- `method` (String) [get, post, put, delete, patch] Request method.
- `password` (String, Sensitive) The password if `authType = basic`.
- `scope` (String) Application-specific scope values for the access token when `authType` is "oauth2".
- `token_url` (String) The endpoint used to request the access token when `authType` is "oauth2".
- `username` (String) The username if `authType = basic`.
- `variables` (Block Set) Array of API post request variable objects. (see [below for nested schema](#nestedblock--requests--variables))
- `wait_time_ms` (Number) Post request delay before executing the next API requests, in milliseconds.

<a id="nestedblock--requests--assertions"></a>
### Nested Schema for `requests.assertions`

Optional:

- `name` (String) [status-code, response-body] Name of assertion.
- `operator` (String) [is, is-not, includes, not-includes] Assertion operator
- `value` (String) The value of the assertion. If name = `status-code`, the status code to assert. If name = `response-body`, the lookup value to assert.


<a id="nestedblock--requests--headers"></a>
### Nested Schema for `requests.headers`

Optional:

- `key` (String) Request header key.
- `value` (String) Request header value. Supports variables `{{variableName}}`.


<a id="nestedblock--requests--variables"></a>
### Nested Schema for `requests.variables`

Optional:

- `name` (String) Variable name.
- `value` (String) The JSON path of data within the Response Body to assign to this variable.



<a id="nestedblock--predefined_variables"></a>
### Nested Schema for `predefined_variables`

Optional:

- `name` (String) Variable name. Must be unique.
- `value` (String) Variable value, will be treated as string.


